在 MapReduce 作业运行过程中任务失败，最常见的情况是 map 任务或 reduce 任务中的用户代码抛出运行异常。如果发生这种情况，任务 JVM 会在退出之前向其父 application master 发送错误报告。错误报告最后被记入用户日志。application master 将此次任务尝试标记为 *failed*（失败），并释放容器以便资源可以为其他任务使用。

另一种失败模式是任务 JVM 突然退出，可能由于 JVM 软件缺陷而导致 MapReduce 用户代码由于特殊原因造成 JVM 退出。在这种情况下，节点管理器会注意到进程已退出，并通知 application master 将此次任务尝试标记为失败。

任务挂起的处理方式则有不同。一旦 application master 注意到已经有一段时间没有收到进度的更新，便会将任务标记为失败。在此之后，任务 JVM 进程将被自动杀死。任务被认为失败的超时时间间隔通常为 10 分钟，可以配置 `mapreduce.task.timeout`。

超时设置为 0 将关闭超时判定，所以长时间运行的任务永远不会被标记为失败。在这种情况下，被挂起的任务永远不会释放它的容器并随着时间的推移最终降低整个集群的效率。因此，尽量避免这种设置，同时充分确保每个任务能够定期汇报其进度。

application master 被告知一个任务尝试失败后，将重新调度该任务的执行。application master 会试图避免在以前失败过的节点管理器上重新调度该任务。此外，如果一个任务失败过 4 次，将不会再重试。这个值是可以设置的：对于 map 任务，运行任务的最多尝试次数有 `mapreduce.map.maxattempts` 属性控制；而对于 reduce 任务，则由 `mapreduce.reduce.maxattempts` 属性控制。在默认情况下，如果任何任务失败次数大于 4 次（或最多尝试次数被配置为 4），整个作业都会失败。

对于一些应用程序，我们不希望一旦有少数几个任务失败就中止运行整个作业，因为即使有任务失败，作业的一些结果可能还是可用的。在这种情况下，可以为作业设置在不触发作业失败的情况下允许任务失败的最大百分比。针对 map 任务和 reduce 任务的设置可以通过 `mapreduce.map.failures.maxpercent` 和 `mapreduce.reduce.failures.maxpercent` 这两个属性来完成。

